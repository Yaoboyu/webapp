<html>
  <head>
    <title>dassdaa</title>
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.4/jquery.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/axios/1.3.6/axios.js"></script>
  </head>
  <body>
    <button id = "login">æ¨¡æ‹Ÿç™»å½•æŒ‰é’®</button>
    <button id = "study">æ¨¡æ‹Ÿå­¦ä¹ æŒ‰é’®</button>
    <button id = "detail">æ¨¡æ‹Ÿä¸ä¼šæŒ‰é’®</button>
    <button id = "sentence">æ¨¡æ‹Ÿæ¨¡ç³ŠæŒ‰é’®</button>
    <button id = "select">æ¨¡æ‹ŸæŸ¥è¯¢æŒ‰é’®</button>
    <button id = "start">å¼€å§‹å­¦ä¹ å•è¯</button>
    <button id = "get">ä¼šè¿™ä¸ªå•è¯ğŸ˜Š</button>
    <div id = "word"></div>
    <div id = "plan"></div>
    <script>
      var userName = "yaoboyu";//ç”¨æˆ·å
      var password = "yaoboyu";//å¯†ç 
      var wordList;//å•è¯åˆ—è¡¨å­˜æ”¾10ä¸ªå¾…å­¦ä¹ å•è¯
      var token = "";//ç™»å½•ä»¤ç‰Œ,é»˜è®¤ä¸ºç©º
      var word = "apple";//å½“å‰å­¦ä¹ çš„å•è¯
      var sentence;//å•è¯ä¾‹å¥
      var detail;//è¯¦æƒ…é¡µ
      var book;//è¯ä¹¦
      var len;//å•è¯åˆ—è¡¨é•¿åº¦
      var index = 0;//å•è¯ç´¢å¼•
      var tmp = [];//å·²ç»å­¦ä¹ çš„å•è¯è¡¨
      axios.defaults.baseURL = "http://localhost:8080";
      axios.interceptors.response.use(function (response) {
          // 2xx èŒƒå›´å†…çš„çŠ¶æ€ç éƒ½ä¼šè§¦å‘è¯¥å‡½æ•°ã€‚
          if(response.data.code != 1)
            alert(response.data.msg);
          return response;
        }, function (error) {
          // è¶…å‡º 2xx èŒƒå›´çš„çŠ¶æ€ç éƒ½ä¼šè§¦å‘è¯¥å‡½æ•°ã€‚
          alert("æœåŠ¡å™¨å¼‚å¸¸ğŸ¤¢");
        });
      //ç™»å½•æ¥å£å®ç°
      $("#login").click(function(){
        console.log("å‘é€ç™»å½•è¯·æ±‚");
        axios({
          headers:{token:token},
          method:"POST",
          url:"/user/login",
          data:{
            userName:userName,
            password:password,
          },
        }).then(response=>{
          token = response.data.data;
          console.log("è·å–tokenä»¤ç‰Œ:" + token);
        })
      })
      //æŸ¥è¯¢ç”¨æˆ·æ‰€å­¦è¯ä¹¦
      $("#select").click(function(){
        console.log("æŸ¥è¯¢ç”¨æˆ·æ‰€å­¦è¯ä¹¦");
        axios({
          method:"GET",
          headers:{token:token},
          url:"/book",
        }).then(response=>{
          book = response.data.data.title;
          console.log("è·å–è¦å­¦ä¹ çš„è¯ä¹¦" + book);
        })
      })
      //å­¦ä¹ æ¥å£å®ç°
      $("#study").click(function(){
        console.log("å‘é€studyè¯·æ±‚");
        axios({
          method:"GET",
          headers:{token:token},
          url:"/study/words",
        }).then(response=>{
          wordList = response.data.data;
          len = wordList.length;
          console.log("è·å–è¦å­¦ä¹ çš„å•è¯åˆ—è¡¨" + len + "ä¸ªå•è¯");
        })
      })
      //é€‰æ‹©ä¸ä¼šä¹‹åæŸ¥è¯¢å•è¯è¯¦æƒ…é¡µæ¥å£
      $("#detail").click(function(){
        console.log("å‘é€ä¸ä¼šè¯·æ±‚");
        axios({
          method:"GET",
          headers:{token:token},
          url:"/study/detail/" + word,
        }).then(response=>{
          detail = response.data.data;
          $("#word").html(detail);
          console.log("å±•ç¤ºè¯¦æƒ…é¡µ");
        })
        do{
          index = (index + 1) % len;
        }
        while(tmp.indexOf(wordList[index].word) != -1);
        $("#start").html("çœ‹ç­”æ¡ˆæ‡‚äº†ğŸ˜¡ä¸ç®—å­¦å®Œ,ä¸€ä¼šå†å­¦ä¸€é");
      })
      //é€‰æ‹©æ¨¡ç³Šä¹‹åæŸ¥çœ‹ä¾‹å¥
      $("#sentence").click(function(){
        console.log("å‘é€æ¨¡ç³Šè¯·æ±‚");
        axios({
          method:"GET",
          headers:{token:token},
          url:"/study/sentence/" + word,
        }).then(response=>{
          detail = response.data.data.sentence;
          $("#word").html(detail);
          console.log("å±•ç¤ºä¾‹å¥");
        })            
        $("#start").html("è¿˜æ˜¯ä¸ä¼š?(æ­»äº†å¾—äº†~ğŸ˜”)");
        $("#get").html("é€šè¿‡æç¤ºæŒæ¡,ä¹Ÿç®—æ‹¿ä¸‹!ğŸ‘¿");
      })
      //å¾ªç¯å±•ç¤ºå•è¯æ¨¡å¼
      $("#start").click(function(){
          word = wordList[index].word;
          $("#start").html("å¼€å§‹å­¦ä¹ ä¹‹åè¿™ä¸ªæŒ‰é’®æ²¡ç”¨");
          $("#get").html("ä¼šè¿™ä¸ªå•è¯ğŸ˜Š");
          $("#word").html(word);
          $("#plan").html("å·²ç»å­¦ä¼šå•è¯" + tmp.length + "/" + len);
        }
      )
      $("#get").click(function(){
        tmp.push(word);
        $("#plan").html("å·²ç»å­¦ä¼šå•è¯" + tmp.length + "/" + len);
        if(len == tmp.length){
          alert("å­¦å®ŒåŠ›!ğŸ˜˜");
          return;
        }
          while(tmp.indexOf(wordList[index].word) != -1)
            index = (index + 1) % len;
          word = wordList[index].word;
          $("#word").html(word);
        }
      )
    </script>
  </body>
</html>